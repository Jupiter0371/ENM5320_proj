MNIST dataset - H1_J1-DNN - 1 layers
== sgd with Adam (lr=1.0e-02, weight_decay=1.0e-03, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
100%|██████████████████████████████████████████████████████████████████████████████████████| 9.91M/9.91M [00:00<00:00, 12.7MB/s]
100%|██████████████████████████████████████████████████████████████████████████████████████| 28.9k/28.9k [00:00<00:00, 4.81MB/s]
100%|██████████████████████████████████████████████████████████████████████████████████████| 1.65M/1.65M [00:00<00:00, 3.89MB/s]
100%|██████████████████████████████████████████████████████████████████████████████████████| 4.54k/4.54k [00:00<00:00, 4.55MB/s]
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 2.940190  Accuracy: 62/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 4.200096  Accuracy: 88/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 1.853433  Accuracy: 87/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 3.125454  Accuracy: 90/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 0.932295  Accuracy: 95/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 1.382279  Accuracy: 92/100
Test set:       Average loss: 0.7227, Accuracy:  9477/10000 (94.77%)
Train set:      Average loss: 0.6250, Accuracy: 57060/60000 (95.10%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 0.831313  Accuracy: 96/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 0.413706  Accuracy: 97/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 1.059099  Accuracy: 93/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 0.060344  Accuracy: 100/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 0.281760  Accuracy: 96/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 0.440334  Accuracy: 97/100
Test set:       Average loss: 0.3644, Accuracy:  9590/10000 (95.90%)
Train set:      Average loss: 0.2534, Accuracy: 58039/60000 (96.73%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 0.194282  Accuracy: 98/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 0.041096  Accuracy: 99/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.074007  Accuracy: 99/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 0.324889  Accuracy: 96/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 0.099615  Accuracy: 99/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 0.685709  Accuracy: 95/100
Test set:       Average loss: 0.3481, Accuracy:  9557/10000 (95.57%)
Train set:      Average loss: 0.2540, Accuracy: 57807/60000 (96.34%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 0.229445  Accuracy: 99/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 0.159097  Accuracy: 99/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 0.147848  Accuracy: 99/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 0.156064  Accuracy: 99/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 0.271770  Accuracy: 98/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.231916  Accuracy: 98/100
Test set:       Average loss: 0.2121, Accuracy:  9634/10000 (96.34%)
Train set:      Average loss: 0.1087, Accuracy: 58603/60000 (97.67%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.030160  Accuracy: 100/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.124818  Accuracy: 99/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 0.144839  Accuracy: 98/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.085100  Accuracy: 99/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 0.055186  Accuracy: 99/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.224365  Accuracy: 98/100
Test set:       Average loss: 0.1913, Accuracy:  9669/10000 (96.69%)
Train set:      Average loss: 0.0890, Accuracy: 58787/60000 (97.98%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.141485  Accuracy: 99/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.112911  Accuracy: 96/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 0.139257  Accuracy: 96/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.029877  Accuracy: 100/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.008314  Accuracy: 100/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.061350  Accuracy: 99/100
Test set:       Average loss: 0.2013, Accuracy:  9644/10000 (96.44%)
Train set:      Average loss: 0.1027, Accuracy: 58520/60000 (97.53%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.201007  Accuracy: 99/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.044349  Accuracy: 98/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.113082  Accuracy: 98/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.158831  Accuracy: 98/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.017791  Accuracy: 99/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.035436  Accuracy: 99/100
Test set:       Average loss: 0.1620, Accuracy:  9653/10000 (96.53%)
Train set:      Average loss: 0.0757, Accuracy: 58713/60000 (97.86%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.039618  Accuracy: 99/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.035205  Accuracy: 99/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.001737  Accuracy: 100/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.034116  Accuracy: 99/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.031195  Accuracy: 100/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.018262  Accuracy: 100/100
Test set:       Average loss: 0.1348, Accuracy:  9675/10000 (96.75%)
Train set:      Average loss: 0.0471, Accuracy: 59080/60000 (98.47%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.003164  Accuracy: 100/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.047605  Accuracy: 99/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.015399  Accuracy: 100/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.019810  Accuracy: 100/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.129354  Accuracy: 99/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.007579  Accuracy: 100/100
Test set:       Average loss: 0.1182, Accuracy:  9703/10000 (97.03%)
Train set:      Average loss: 0.0468, Accuracy: 59097/60000 (98.50%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.084045  Accuracy: 99/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.021559  Accuracy: 99/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.030542  Accuracy: 99/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.011385  Accuracy: 100/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.036638  Accuracy: 99/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.043919  Accuracy: 99/100
Test set:       Average loss: 0.0966, Accuracy:  9730/10000 (97.30%)
Train set:      Average loss: 0.0371, Accuracy: 59270/60000 (98.78%)




MNIST dataset - H2-DNN - 1 layers
== sgd with Adam (lr=1.0e-02, weight_decay=1.0e-03, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 2.486383  Accuracy: 59/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 1.589407  Accuracy: 91/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 0.922901  Accuracy: 92/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 0.731153  Accuracy: 91/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 0.587489  Accuracy: 95/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 0.719257  Accuracy: 95/100
Test set:       Average loss: 0.4499, Accuracy:  9538/10000 (95.38%)
Train set:      Average loss: 0.4016, Accuracy: 57371/60000 (95.62%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 0.532703  Accuracy: 94/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 0.642679  Accuracy: 96/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 0.442177  Accuracy: 95/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 0.217050  Accuracy: 98/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 0.000719  Accuracy: 100/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 0.238345  Accuracy: 98/100
Test set:       Average loss: 0.3407, Accuracy:  9513/10000 (95.13%)
Train set:      Average loss: 0.2297, Accuracy: 57524/60000 (95.87%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 0.274534  Accuracy: 96/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 0.264845  Accuracy: 97/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.219083  Accuracy: 97/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 0.041378  Accuracy: 99/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 0.129432  Accuracy: 98/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 0.494133  Accuracy: 93/100
Test set:       Average loss: 0.2467, Accuracy:  9550/10000 (95.50%)
Train set:      Average loss: 0.1534, Accuracy: 57968/60000 (96.61%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 0.506472  Accuracy: 93/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 0.047609  Accuracy: 100/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 0.001471  Accuracy: 100/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 0.188074  Accuracy: 98/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 0.049446  Accuracy: 99/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.078588  Accuracy: 99/100
Test set:       Average loss: 0.1600, Accuracy:  9630/10000 (96.30%)
Train set:      Average loss: 0.0949, Accuracy: 58472/60000 (97.45%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.159922  Accuracy: 99/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.130047  Accuracy: 98/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 0.018535  Accuracy: 100/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.086262  Accuracy: 99/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 0.187266  Accuracy: 97/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.110892  Accuracy: 97/100
Test set:       Average loss: 0.1274, Accuracy:  9682/10000 (96.82%)
Train set:      Average loss: 0.0716, Accuracy: 58643/60000 (97.74%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.008880  Accuracy: 100/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.055641  Accuracy: 99/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 0.317682  Accuracy: 94/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.045544  Accuracy: 99/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.019482  Accuracy: 100/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.237588  Accuracy: 97/100
Test set:       Average loss: 0.1357, Accuracy:  9638/10000 (96.38%)
Train set:      Average loss: 0.0814, Accuracy: 58469/60000 (97.45%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.005655  Accuracy: 100/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.021535  Accuracy: 100/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.034829  Accuracy: 100/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.054333  Accuracy: 99/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.037386  Accuracy: 100/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.031600  Accuracy: 99/100
Test set:       Average loss: 0.0972, Accuracy:  9727/10000 (97.27%)
Train set:      Average loss: 0.0460, Accuracy: 59119/60000 (98.53%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.026246  Accuracy: 99/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.044750  Accuracy: 99/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.043600  Accuracy: 100/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.089653  Accuracy: 97/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.143104  Accuracy: 97/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.042293  Accuracy: 99/100
Test set:       Average loss: 0.0821, Accuracy:  9743/10000 (97.43%)
Train set:      Average loss: 0.0367, Accuracy: 59272/60000 (98.79%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.029322  Accuracy: 99/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.044322  Accuracy: 99/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.050610  Accuracy: 99/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.005811  Accuracy: 100/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.021425  Accuracy: 100/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.014175  Accuracy: 100/100
Test set:       Average loss: 0.0906, Accuracy:  9724/10000 (97.24%)
Train set:      Average loss: 0.0384, Accuracy: 59260/60000 (98.77%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.025452  Accuracy: 100/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.033993  Accuracy: 99/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.010057  Accuracy: 100/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.083667  Accuracy: 98/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.011235  Accuracy: 100/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.019886  Accuracy: 100/100
Test set:       Average loss: 0.0905, Accuracy:  9734/10000 (97.34%)
Train set:      Average loss: 0.0359, Accuracy: 59307/60000 (98.84%)

Network trained!
Test accuracy: 97.43%  - Train accuracy: 98.787%
------------------------------------------------------------------

MNIST dataset - H2-DNN - 5 layers
== sgd with Adam (lr=1.0e-02, weight_decay=1.0e-03, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 4.647414  Accuracy: 61/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 5.284404  Accuracy: 85/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 4.626740  Accuracy: 91/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 1.838163  Accuracy: 98/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 5.477624  Accuracy: 85/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 2.014031  Accuracy: 97/100
Test set:       Average loss: 1.7934, Accuracy:  9293/10000 (92.93%)
Train set:      Average loss: 1.5143, Accuracy: 56018/60000 (93.36%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 2.787009  Accuracy: 95/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 3.119059  Accuracy: 93/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 2.225197  Accuracy: 95/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 1.886906  Accuracy: 96/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 1.021923  Accuracy: 99/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 2.766247  Accuracy: 97/100
Test set:       Average loss: 1.0855, Accuracy:  9498/10000 (94.98%)
Train set:      Average loss: 0.8622, Accuracy: 57438/60000 (95.73%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 1.559909  Accuracy: 98/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 1.617403  Accuracy: 98/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.951413  Accuracy: 100/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 1.302380  Accuracy: 97/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 1.550169  Accuracy: 98/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 2.016013  Accuracy: 94/100
Test set:       Average loss: 0.9851, Accuracy:  9499/10000 (94.99%)
Train set:      Average loss: 0.5911, Accuracy: 57553/60000 (95.92%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 1.833470  Accuracy: 95/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 1.155146  Accuracy: 98/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 1.198928  Accuracy: 97/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 1.138710  Accuracy: 98/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 3.168323  Accuracy: 92/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.888249  Accuracy: 98/100
Test set:       Average loss: 0.6621, Accuracy:  9622/10000 (96.22%)
Train set:      Average loss: 0.3259, Accuracy: 58470/60000 (97.45%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.791709  Accuracy: 99/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.898456  Accuracy: 98/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 1.147247  Accuracy: 97/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.702618  Accuracy: 100/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 1.150554  Accuracy: 98/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.719448  Accuracy: 99/100
Test set:       Average loss: 0.4935, Accuracy:  9684/10000 (96.84%)
Train set:      Average loss: 0.1680, Accuracy: 59015/60000 (98.36%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.944476  Accuracy: 99/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.912136  Accuracy: 99/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 1.179569  Accuracy: 98/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.627458  Accuracy: 100/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.695399  Accuracy: 99/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.707947  Accuracy: 100/100
Test set:       Average loss: 0.4567, Accuracy:  9659/10000 (96.59%)
Train set:      Average loss: 0.1060, Accuracy: 59126/60000 (98.54%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.607148  Accuracy: 100/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.915768  Accuracy: 98/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.592764  Accuracy: 100/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.658947  Accuracy: 99/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.628468  Accuracy: 100/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.683403  Accuracy: 99/100
Test set:       Average loss: 0.4495, Accuracy:  9638/10000 (96.38%)
Train set:      Average loss: 0.1156, Accuracy: 59045/60000 (98.41%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.742370  Accuracy: 99/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.537470  Accuracy: 100/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.577353  Accuracy: 100/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.525834  Accuracy: 100/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.613033  Accuracy: 100/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.505284  Accuracy: 100/100
Test set:       Average loss: 0.2858, Accuracy:  9729/10000 (97.29%)
Train set:      Average loss: 0.0381, Accuracy: 59531/60000 (99.22%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.625286  Accuracy: 99/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.578853  Accuracy: 99/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.533801  Accuracy: 100/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.536756  Accuracy: 99/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.477967  Accuracy: 100/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.638981  Accuracy: 98/100
Test set:       Average loss: 0.2658, Accuracy:  9721/10000 (97.21%)
Train set:      Average loss: 0.0268, Accuracy: 59613/60000 (99.36%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.461671  Accuracy: 100/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.517993  Accuracy: 99/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.449928  Accuracy: 100/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.437132  Accuracy: 100/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.463220  Accuracy: 100/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.424336  Accuracy: 100/100
Test set:       Average loss: 0.2619, Accuracy:  9710/10000 (97.10%)
Train set:      Average loss: 0.0289, Accuracy: 59553/60000 (99.25%)

Network trained!
Test accuracy: 97.29%  - Train accuracy: 99.218%
------------------------------------------------------------------

MNIST dataset - H1_J2-DNN - 5 layers
== sgd with Adam (lr=1.0e-02, weight_decay=2.0e-04, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 3.522033  Accuracy: 54/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 3.780606  Accuracy: 90/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 2.815733  Accuracy: 93/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 0.423335  Accuracy: 97/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 1.446336  Accuracy: 94/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 1.845166  Accuracy: 95/100
Test set:       Average loss: 1.1374, Accuracy:  9495/10000 (94.95%)
Train set:      Average loss: 0.9963, Accuracy: 57300/60000 (95.50%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 2.196653  Accuracy: 91/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 0.560391  Accuracy: 99/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 0.430570  Accuracy: 98/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 0.693777  Accuracy: 97/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 0.216201  Accuracy: 100/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 0.706164  Accuracy: 98/100
Test set:       Average loss: 0.6312, Accuracy:  9689/10000 (96.89%)
Train set:      Average loss: 0.3067, Accuracy: 58728/60000 (97.88%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 0.579758  Accuracy: 99/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 0.522069  Accuracy: 98/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.307026  Accuracy: 98/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 0.398002  Accuracy: 99/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 0.255251  Accuracy: 100/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 0.615435  Accuracy: 99/100
Test set:       Average loss: 0.6850, Accuracy:  9585/10000 (95.85%)
Train set:      Average loss: 0.3910, Accuracy: 58141/60000 (96.90%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 0.262603  Accuracy: 99/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 0.954290  Accuracy: 97/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 0.453617  Accuracy: 99/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 0.262886  Accuracy: 100/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 0.548291  Accuracy: 98/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.743373  Accuracy: 97/100
Test set:       Average loss: 0.5881, Accuracy:  9612/10000 (96.12%)
Train set:      Average loss: 0.2318, Accuracy: 58603/60000 (97.67%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.650886  Accuracy: 98/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.436201  Accuracy: 99/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 1.157967  Accuracy: 98/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.780013  Accuracy: 98/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 0.446552  Accuracy: 99/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.535698  Accuracy: 99/100
Test set:       Average loss: 0.4222, Accuracy:  9705/10000 (97.05%)
Train set:      Average loss: 0.1376, Accuracy: 59080/60000 (98.47%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.494939  Accuracy: 98/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.235673  Accuracy: 99/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 0.254688  Accuracy: 99/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.372914  Accuracy: 99/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.245799  Accuracy: 99/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.407115  Accuracy: 99/100
Test set:       Average loss: 0.3704, Accuracy:  9721/10000 (97.21%)
Train set:      Average loss: 0.0797, Accuracy: 59318/60000 (98.86%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.178062  Accuracy: 100/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.177976  Accuracy: 100/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.248139  Accuracy: 100/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.193538  Accuracy: 100/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.494778  Accuracy: 99/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.174192  Accuracy: 100/100
Test set:       Average loss: 0.3300, Accuracy:  9736/10000 (97.36%)
Train set:      Average loss: 0.0572, Accuracy: 59461/60000 (99.10%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.185915  Accuracy: 100/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.202767  Accuracy: 100/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.315608  Accuracy: 98/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.211562  Accuracy: 100/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.171423  Accuracy: 100/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.537484  Accuracy: 98/100
Test set:       Average loss: 0.3068, Accuracy:  9746/10000 (97.46%)
Train set:      Average loss: 0.0402, Accuracy: 59544/60000 (99.24%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.211693  Accuracy: 100/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.166357  Accuracy: 100/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.165581  Accuracy: 100/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.164823  Accuracy: 100/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.167386  Accuracy: 100/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.188265  Accuracy: 100/100
Test set:       Average loss: 0.2687, Accuracy:  9755/10000 (97.55%)
Train set:      Average loss: 0.0309, Accuracy: 59632/60000 (99.39%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.167439  Accuracy: 100/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.161338  Accuracy: 100/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.160623  Accuracy: 100/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.166043  Accuracy: 100/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.159620  Accuracy: 100/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.296524  Accuracy: 98/100
Test set:       Average loss: 0.2571, Accuracy:  9766/10000 (97.66%)
Train set:      Average loss: 0.0124, Accuracy: 59790/60000 (99.65%)

Network trained!
Test accuracy: 97.66%  - Train accuracy: 99.650%
------------------------------------------------------------------

MNIST dataset - H2_Global - 5 layers
== sgd with Adam (lr=1.0e-02, weight_decay=2.0e-04, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 2.574763  Accuracy: 9/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 0.153660  Accuracy: 98/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 0.143594  Accuracy: 96/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 0.080803  Accuracy: 99/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 0.039621  Accuracy: 100/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 0.057462  Accuracy: 99/100
Test set:       Average loss: 0.0858, Accuracy:  9739/10000 (97.39%)
Train set:      Average loss: 0.0877, Accuracy: 58332/60000 (97.22%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 0.053296  Accuracy: 99/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 0.015047  Accuracy: 99/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 0.077343  Accuracy: 99/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 0.061145  Accuracy: 98/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 0.112802  Accuracy: 96/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 0.041861  Accuracy: 99/100
Test set:       Average loss: 0.0571, Accuracy:  9809/10000 (98.09%)
Train set:      Average loss: 0.0497, Accuracy: 59055/60000 (98.42%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 0.016854  Accuracy: 100/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 0.013780  Accuracy: 100/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.096091  Accuracy: 98/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 0.046558  Accuracy: 99/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 0.051051  Accuracy: 99/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 0.016556  Accuracy: 100/100
Test set:       Average loss: 0.0527, Accuracy:  9840/10000 (98.40%)
Train set:      Average loss: 0.0395, Accuracy: 59257/60000 (98.76%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 0.089989  Accuracy: 98/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 0.100919  Accuracy: 98/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 0.041923  Accuracy: 99/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 0.055051  Accuracy: 99/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 0.008575  Accuracy: 100/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.030322  Accuracy: 100/100
Test set:       Average loss: 0.0525, Accuracy:  9845/10000 (98.45%)
Train set:      Average loss: 0.0383, Accuracy: 59269/60000 (98.78%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.007982  Accuracy: 100/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.008800  Accuracy: 100/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 0.044426  Accuracy: 99/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.005961  Accuracy: 100/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 0.012843  Accuracy: 100/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.076521  Accuracy: 99/100
Test set:       Average loss: 0.0536, Accuracy:  9833/10000 (98.33%)
Train set:      Average loss: 0.0325, Accuracy: 59405/60000 (99.01%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.049986  Accuracy: 99/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.003692  Accuracy: 100/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 0.103401  Accuracy: 98/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.002149  Accuracy: 100/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.051538  Accuracy: 99/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.008705  Accuracy: 100/100
Test set:       Average loss: 0.0462, Accuracy:  9847/10000 (98.47%)
Train set:      Average loss: 0.0236, Accuracy: 59545/60000 (99.24%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.032244  Accuracy: 100/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.006742  Accuracy: 100/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.019559  Accuracy: 99/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.004481  Accuracy: 100/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.015103  Accuracy: 100/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.014974  Accuracy: 100/100
Test set:       Average loss: 0.0439, Accuracy:  9860/10000 (98.60%)
Train set:      Average loss: 0.0190, Accuracy: 59655/60000 (99.42%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.008676  Accuracy: 100/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.008825  Accuracy: 100/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.002963  Accuracy: 100/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.002649  Accuracy: 100/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.006248  Accuracy: 100/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.055941  Accuracy: 99/100
Test set:       Average loss: 0.0436, Accuracy:  9859/10000 (98.59%)
Train set:      Average loss: 0.0154, Accuracy: 59747/60000 (99.58%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.009589  Accuracy: 100/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.002498  Accuracy: 100/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.006545  Accuracy: 100/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.017837  Accuracy: 100/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.003559  Accuracy: 100/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.044158  Accuracy: 98/100
Test set:       Average loss: 0.0425, Accuracy:  9863/10000 (98.63%)
Train set:      Average loss: 0.0132, Accuracy: 59805/60000 (99.67%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.015439  Accuracy: 100/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.000590  Accuracy: 100/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.007583  Accuracy: 100/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.001318  Accuracy: 100/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.006680  Accuracy: 100/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.007182  Accuracy: 100/100
Test set:       Average loss: 0.0387, Accuracy:  9874/10000 (98.74%)
Train set:      Average loss: 0.0097, Accuracy: 59861/60000 (99.77%)
--------------------------------------------------------------------------------------------
MNIST dataset - H1_J2-DNN - 10 layers
== sgd with Adam (lr=1.0e-02, weight_decay=2.0e-04, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 3.486130  Accuracy: 21/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 0.312895  Accuracy: 97/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 0.134617  Accuracy: 98/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 0.059899  Accuracy: 100/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 0.089359  Accuracy: 98/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 0.064905  Accuracy: 99/100
Test set:       Average loss: 0.0765, Accuracy:  9751/10000 (97.51%)
Train set:      Average loss: 0.0716, Accuracy: 58635/60000 (97.72%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 0.046139  Accuracy: 99/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 0.081197  Accuracy: 98/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 0.006133  Accuracy: 100/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 0.021274  Accuracy: 100/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 0.024431  Accuracy: 100/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 0.090094  Accuracy: 98/100
Test set:       Average loss: 0.0707, Accuracy:  9775/10000 (97.75%)
Train set:      Average loss: 0.0609, Accuracy: 58879/60000 (98.13%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 0.027568  Accuracy: 99/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 0.036331  Accuracy: 99/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.053059  Accuracy: 98/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 0.068139  Accuracy: 99/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 0.053228  Accuracy: 99/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 0.119961  Accuracy: 96/100
Test set:       Average loss: 0.0571, Accuracy:  9806/10000 (98.06%)
Train set:      Average loss: 0.0425, Accuracy: 59216/60000 (98.69%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 0.010474  Accuracy: 100/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 0.030311  Accuracy: 100/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 0.052085  Accuracy: 100/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 0.031006  Accuracy: 99/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 0.011271  Accuracy: 100/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.111232  Accuracy: 98/100
Test set:       Average loss: 0.0492, Accuracy:  9847/10000 (98.47%)
Train set:      Average loss: 0.0350, Accuracy: 59338/60000 (98.90%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.025442  Accuracy: 99/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.074420  Accuracy: 97/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 0.094241  Accuracy: 98/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.004544  Accuracy: 100/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 0.039604  Accuracy: 98/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.025914  Accuracy: 100/100
Test set:       Average loss: 0.0529, Accuracy:  9833/10000 (98.33%)
Train set:      Average loss: 0.0321, Accuracy: 59382/60000 (98.97%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.019923  Accuracy: 100/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.043830  Accuracy: 99/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 0.009772  Accuracy: 100/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.066155  Accuracy: 98/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.013056  Accuracy: 100/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.018776  Accuracy: 99/100
Test set:       Average loss: 0.0479, Accuracy:  9838/10000 (98.38%)
Train set:      Average loss: 0.0269, Accuracy: 59485/60000 (99.14%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.092429  Accuracy: 97/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.027352  Accuracy: 99/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.006109  Accuracy: 100/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.019977  Accuracy: 99/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.005686  Accuracy: 100/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.030084  Accuracy: 99/100
Test set:       Average loss: 0.0402, Accuracy:  9860/10000 (98.60%)
Train set:      Average loss: 0.0168, Accuracy: 59700/60000 (99.50%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.009839  Accuracy: 100/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.022982  Accuracy: 100/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.012067  Accuracy: 100/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.006473  Accuracy: 100/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.003414  Accuracy: 100/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.001242  Accuracy: 100/100
Test set:       Average loss: 0.0406, Accuracy:  9859/10000 (98.59%)
Train set:      Average loss: 0.0136, Accuracy: 59771/60000 (99.62%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.003543  Accuracy: 100/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.031678  Accuracy: 98/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.001963  Accuracy: 100/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.039445  Accuracy: 100/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.007886  Accuracy: 100/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.013725  Accuracy: 100/100
Test set:       Average loss: 0.0375, Accuracy:  9870/10000 (98.70%)
Train set:      Average loss: 0.0125, Accuracy: 59804/60000 (99.67%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.026970  Accuracy: 98/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.004472  Accuracy: 100/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.009352  Accuracy: 100/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.014812  Accuracy: 100/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.010583  Accuracy: 100/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.002696  Accuracy: 100/100
Test set:       Average loss: 0.0369, Accuracy:  9869/10000 (98.69%)
Train set:      Average loss: 0.0092, Accuracy: 59875/60000 (99.79%)

Network trained!
Test accuracy: 98.70%  - Train accuracy: 99.673%
------------------------------------------------------------------
MNIST dataset - H1_Global - 50 layers
== sgd with Adam (lr=1.0e-02, weight_decay=2.0e-04, gamma=0.8, max_epochs=10, alpha=1.0e-03, minibatch=100)
        Train Epoch:  1 [    0/60000 ( 0%)]     Loss: 34.566837 Accuracy: 12/100
        Train Epoch:  1 [10000/60000 (17%)]     Loss: 5.015619  Accuracy: 95/100
        Train Epoch:  1 [20000/60000 (33%)]     Loss: 1.148352  Accuracy: 96/100
        Train Epoch:  1 [30000/60000 (50%)]     Loss: 0.407621  Accuracy: 97/100
        Train Epoch:  1 [40000/60000 (67%)]     Loss: 0.287748  Accuracy: 95/100
        Train Epoch:  1 [50000/60000 (83%)]     Loss: 0.197589  Accuracy: 95/100
Test set:       Average loss: 0.1397, Accuracy:  9534/10000 (95.34%)
Train set:      Average loss: 0.1512, Accuracy: 57025/60000 (95.04%)
        Train Epoch:  2 [    0/60000 ( 0%)]     Loss: 0.182317  Accuracy: 95/100
        Train Epoch:  2 [10000/60000 (17%)]     Loss: 0.123082  Accuracy: 97/100
        Train Epoch:  2 [20000/60000 (33%)]     Loss: 0.171109  Accuracy: 95/100
        Train Epoch:  2 [30000/60000 (50%)]     Loss: 0.131606  Accuracy: 97/100
        Train Epoch:  2 [40000/60000 (67%)]     Loss: 0.071454  Accuracy: 99/100
        Train Epoch:  2 [50000/60000 (83%)]     Loss: 0.244159  Accuracy: 94/100
Test set:       Average loss: 0.1196, Accuracy:  9610/10000 (96.10%)
Train set:      Average loss: 0.1313, Accuracy: 57447/60000 (95.75%)
        Train Epoch:  3 [    0/60000 ( 0%)]     Loss: 0.180907  Accuracy: 92/100
        Train Epoch:  3 [10000/60000 (17%)]     Loss: 0.215579  Accuracy: 94/100
        Train Epoch:  3 [20000/60000 (33%)]     Loss: 0.030983  Accuracy: 100/100
        Train Epoch:  3 [30000/60000 (50%)]     Loss: 0.076574  Accuracy: 98/100
        Train Epoch:  3 [40000/60000 (67%)]     Loss: 0.098541  Accuracy: 97/100
        Train Epoch:  3 [50000/60000 (83%)]     Loss: 0.104215  Accuracy: 97/100
Test set:       Average loss: 0.0956, Accuracy:  9682/10000 (96.82%)
Train set:      Average loss: 0.1047, Accuracy: 58049/60000 (96.75%)
        Train Epoch:  4 [    0/60000 ( 0%)]     Loss: 0.185825  Accuracy: 96/100
        Train Epoch:  4 [10000/60000 (17%)]     Loss: 0.224449  Accuracy: 94/100
        Train Epoch:  4 [20000/60000 (33%)]     Loss: 0.125766  Accuracy: 98/100
        Train Epoch:  4 [30000/60000 (50%)]     Loss: 0.096609  Accuracy: 98/100
        Train Epoch:  4 [40000/60000 (67%)]     Loss: 0.045712  Accuracy: 99/100
        Train Epoch:  4 [50000/60000 (83%)]     Loss: 0.111278  Accuracy: 97/100
Test set:       Average loss: 0.0852, Accuracy:  9733/10000 (97.33%)
Train set:      Average loss: 0.0896, Accuracy: 58308/60000 (97.18%)
        Train Epoch:  5 [    0/60000 ( 0%)]     Loss: 0.172821  Accuracy: 96/100
        Train Epoch:  5 [10000/60000 (17%)]     Loss: 0.029533  Accuracy: 99/100
        Train Epoch:  5 [20000/60000 (33%)]     Loss: 0.089278  Accuracy: 96/100
        Train Epoch:  5 [30000/60000 (50%)]     Loss: 0.033997  Accuracy: 99/100
        Train Epoch:  5 [40000/60000 (67%)]     Loss: 0.088470  Accuracy: 97/100
        Train Epoch:  5 [50000/60000 (83%)]     Loss: 0.045853  Accuracy: 98/100
Test set:       Average loss: 0.0845, Accuracy:  9746/10000 (97.46%)
Train set:      Average loss: 0.0831, Accuracy: 58457/60000 (97.43%)
        Train Epoch:  6 [    0/60000 ( 0%)]     Loss: 0.058789  Accuracy: 99/100
        Train Epoch:  6 [10000/60000 (17%)]     Loss: 0.053357  Accuracy: 99/100
        Train Epoch:  6 [20000/60000 (33%)]     Loss: 0.102372  Accuracy: 98/100
        Train Epoch:  6 [30000/60000 (50%)]     Loss: 0.067405  Accuracy: 99/100
        Train Epoch:  6 [40000/60000 (67%)]     Loss: 0.079014  Accuracy: 98/100
        Train Epoch:  6 [50000/60000 (83%)]     Loss: 0.079224  Accuracy: 98/100
Test set:       Average loss: 0.0875, Accuracy:  9737/10000 (97.37%)
Train set:      Average loss: 0.0858, Accuracy: 58340/60000 (97.23%)
        Train Epoch:  7 [    0/60000 ( 0%)]     Loss: 0.139871  Accuracy: 96/100
        Train Epoch:  7 [10000/60000 (17%)]     Loss: 0.107168  Accuracy: 97/100
        Train Epoch:  7 [20000/60000 (33%)]     Loss: 0.159580  Accuracy: 97/100
        Train Epoch:  7 [30000/60000 (50%)]     Loss: 0.110714  Accuracy: 97/100
        Train Epoch:  7 [40000/60000 (67%)]     Loss: 0.056221  Accuracy: 97/100
        Train Epoch:  7 [50000/60000 (83%)]     Loss: 0.021867  Accuracy: 99/100
Test set:       Average loss: 0.0664, Accuracy:  9799/10000 (97.99%)
Train set:      Average loss: 0.0653, Accuracy: 58773/60000 (97.95%)
        Train Epoch:  8 [    0/60000 ( 0%)]     Loss: 0.018438  Accuracy: 100/100
        Train Epoch:  8 [10000/60000 (17%)]     Loss: 0.017870  Accuracy: 100/100
        Train Epoch:  8 [20000/60000 (33%)]     Loss: 0.112284  Accuracy: 96/100
        Train Epoch:  8 [30000/60000 (50%)]     Loss: 0.065962  Accuracy: 97/100
        Train Epoch:  8 [40000/60000 (67%)]     Loss: 0.189171  Accuracy: 96/100
        Train Epoch:  8 [50000/60000 (83%)]     Loss: 0.036901  Accuracy: 99/100
Test set:       Average loss: 0.0659, Accuracy:  9789/10000 (97.89%)
Train set:      Average loss: 0.0600, Accuracy: 58879/60000 (98.13%)
        Train Epoch:  9 [    0/60000 ( 0%)]     Loss: 0.089980  Accuracy: 95/100
        Train Epoch:  9 [10000/60000 (17%)]     Loss: 0.017895  Accuracy: 99/100
        Train Epoch:  9 [20000/60000 (33%)]     Loss: 0.106436  Accuracy: 95/100
        Train Epoch:  9 [30000/60000 (50%)]     Loss: 0.051755  Accuracy: 98/100
        Train Epoch:  9 [40000/60000 (67%)]     Loss: 0.050903  Accuracy: 98/100
        Train Epoch:  9 [50000/60000 (83%)]     Loss: 0.053377  Accuracy: 98/100
Test set:       Average loss: 0.0739, Accuracy:  9775/10000 (97.75%)
Train set:      Average loss: 0.0660, Accuracy: 58741/60000 (97.90%)
        Train Epoch: 10 [    0/60000 ( 0%)]     Loss: 0.067899  Accuracy: 98/100
        Train Epoch: 10 [10000/60000 (17%)]     Loss: 0.018577  Accuracy: 99/100
        Train Epoch: 10 [20000/60000 (33%)]     Loss: 0.057649  Accuracy: 99/100
        Train Epoch: 10 [30000/60000 (50%)]     Loss: 0.039808  Accuracy: 99/100
        Train Epoch: 10 [40000/60000 (67%)]     Loss: 0.053576  Accuracy: 98/100
        Train Epoch: 10 [50000/60000 (83%)]     Loss: 0.044234  Accuracy: 99/100
Test set:       Average loss: 0.0672, Accuracy:  9793/10000 (97.93%)
Train set:      Average loss: 0.0580, Accuracy: 58915/60000 (98.19%)

Network trained!
Test accuracy: 97.99%  - Train accuracy: 97.955%
------------------------------------------------------------------